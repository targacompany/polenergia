class BeamsAnimation{constructor(e){this.container=e,this.beamLength=115,this.beamSpeedMin=4,this.beamSpeedMax=5,this.occupiedLines=new Set,this.activeBeams=[],this.allLines=[],this.hasActiveHorizontalBeam=!1,this.hasActiveVerticalBeam=!1,this.init()}getThemeColors(e){const t=e.classList.contains("section")?e:e.closest(".section");return t&&t.classList.contains("theme-dark")?{beamStartColor:"#01EFA7",beamEndColor:"rgba(31, 48, 112, 0.5)"}:{beamStartColor:"#01EFA7",beamEndColor:"transparent"}}init(){const e=this.container.querySelectorAll(".horizontal-line"),t=this.container.querySelectorAll(".vertical-line");this.allLines=[],e.forEach(e=>{this.allLines.push({element:e,isVertical:!1})}),t.forEach(e=>{this.allLines.push({element:e,isVertical:!0})}),setTimeout(()=>{this.startBeam(!1),this.startBeam(!0)},4e3),this.observer=new MutationObserver(e=>{e.forEach(e=>{e.addedNodes.forEach(e=>{if(e.nodeType===Node.ELEMENT_NODE&&(e.classList&&e.classList.contains("horizontal-line")&&this.allLines.push({element:e,isVertical:!1}),e.classList&&e.classList.contains("vertical-line")&&this.allLines.push({element:e,isVertical:!0}),e.querySelectorAll)){const t=e.querySelectorAll(".horizontal-line"),i=e.querySelectorAll(".vertical-line");t.forEach(e=>{this.allLines.push({element:e,isVertical:!1})}),i.forEach(e=>{this.allLines.push({element:e,isVertical:!0})})}})})}),this.observer.observe(this.container,{childList:!0,subtree:!0})}isInViewport(e){const t=e.getBoundingClientRect();return t.top<window.innerHeight&&t.bottom>0&&t.left<window.innerWidth&&t.right>0}startBeam(e){if(e&&this.hasActiveVerticalBeam)return;if(!e&&this.hasActiveHorizontalBeam)return;const t=this.allLines.filter(t=>{const i=this.getLineId(t.element);return t.isVertical===e&&!this.occupiedLines.has(i)&&this.isInViewport(t.element)});if(0===t.length)return void setTimeout(()=>this.startBeam(e),500);const i=t[Math.floor(Math.random()*t.length)],s=this.getLineId(i.element);this.createBeam(i.element,i.isVertical,s)}getLineId(e){return e.dataset.beamLineId||(e.dataset.beamLineId="line_"+Math.random().toString(36).substr(2,9)),e.dataset.beamLineId}createBeam(e,t,i){const s=e.getBoundingClientRect(),n=e.closest("[data-bkg]");if(!n)return;const a=this.getThemeColors(n);let o;o=t?`linear-gradient(0deg, ${a.beamStartColor} 0%, ${a.beamEndColor} 100%)`:`linear-gradient(270deg, ${a.beamStartColor} 0%, ${a.beamEndColor} 100%)`;const r=document.createElement("div");if(r.className="animated-beam",Object.assign(r.style,{position:"absolute",pointerEvents:"none",opacity:"0.9",background:o,borderRadius:"0.25rem",zIndex:"1"}),t){const e=-this.beamLength;Object.assign(r.style,{width:"2px",height:this.beamLength+"px",left:"50%",transform:"translateX(-50%)",top:e+"px"})}else{const e=-this.beamLength;Object.assign(r.style,{height:"2px",width:this.beamLength+"px",top:"50%",transform:"translateY(-50%)",left:e+"px"})}"static"===window.getComputedStyle(e).position&&(e.style.position="relative"),e.appendChild(r),this.occupiedLines.add(i),t?this.hasActiveVerticalBeam=!0:this.hasActiveHorizontalBeam=!0;const l=this.beamSpeedMin+Math.random()*(this.beamSpeedMax-this.beamSpeedMin),c=gsap.timeline({onComplete:()=>{r.remove(),this.occupiedLines.delete(i),t?this.hasActiveVerticalBeam=!1:this.hasActiveHorizontalBeam=!1;const e=this.activeBeams.findIndex(e=>e.beam===r);e>-1&&this.activeBeams.splice(e,1),this.startBeam(t)}});if(t){const e=s.height+this.beamLength;c.to(r,{top:e+"px",duration:l,ease:"power1.inOut"})}else{const e=s.width+this.beamLength;c.to(r,{left:e+"px",duration:l,ease:"power1.inOut"})}r.timeline=c,this.activeBeams.push({beam:r,timeline:c,lineId:i})}destroy(){this.observer&&this.observer.disconnect(),this.activeBeams.forEach(({beam:e,timeline:t})=>{t&&t.kill(),e&&e.parentElement&&e.remove()}),this.activeBeams=[],this.occupiedLines.clear(),this.hasActiveHorizontalBeam=!1,this.hasActiveVerticalBeam=!1}}const beamsAnimationInstances=[];function initBeamsAnimations(){document.querySelectorAll(".bkg-grid-wrap").forEach(e=>{if(e.beamsAnimationInstance)return;const t=new BeamsAnimation(e);e.beamsAnimationInstance=t,beamsAnimationInstances.push(t)})}document.addEventListener("DOMContentLoaded",()=>{initBeamsAnimations()}),"loading"!==document.readyState&&initBeamsAnimations();const containerObserver=new MutationObserver(e=>{e.forEach(e=>{e.addedNodes.forEach(e=>{if(e.nodeType===Node.ELEMENT_NODE){if(e.classList&&e.classList.contains("bkg-grid-wrap")&&!e.beamsAnimationInstance){const t=new BeamsAnimation(e);e.beamsAnimationInstance=t,beamsAnimationInstances.push(t)}if(e.querySelectorAll){e.querySelectorAll(".bkg-grid-wrap").forEach(e=>{if(!e.beamsAnimationInstance){const t=new BeamsAnimation(e);e.beamsAnimationInstance=t,beamsAnimationInstances.push(t)}})}}})})});containerObserver.observe(document.body,{childList:!0,subtree:!0}),window.BeamsAnimation=BeamsAnimation,window.beamsAnimationInstances=beamsAnimationInstances,window.initBeamsAnimations=initBeamsAnimations;